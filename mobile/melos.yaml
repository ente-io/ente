# A name for your monorepo
name: ente_workspace

# Location of your packages, using glob patterns.
# Melos will find any pubspec.yaml file inside these directories.
packages:
  - apps/*
  - packages/*

# Scripts that can be run with `melos run <script_name>`
scripts:
  # The very first command you should run. It links all your local packages
  # together and runs `flutter pub get` everywhere.
  bootstrap:
    run: melos bootstrap
    description: Bootstrap the workspace, linking local packages.

  # --- GLOBAL COMMANDS (run on all apps & packages) ---

  get:all:
    run: melos exec -- "flutter pub get"
    description: Run "flutter pub get" in all projects.

  clean:all:
    run: melos exec -- "flutter clean"
    description: Run "flutter clean" in all projects.

  # --- APP-SPECIFIC CLEAN COMMANDS ---
  # These scripts use `--scope` to target only a specific app.
  # IMPORTANT: The scope name (e.g., "photos") must match the `name`
  # field in that app's `pubspec.yaml` file.

  clean:photos:
    run: melos exec --scope="photos" -- "flutter clean"
    description: Clean the 'photos' app.

  clean:auth:
    run: melos exec --scope="auth" -- "flutter clean"
    description: Clean the 'auth' app.

  clean:locker:
    run: melos exec --scope="locker" -- "flutter clean"
    description: Clean the 'locker' app.


  run:photos:apk:
    run: melos exec --scope="photos" -- "flutter run -t lib/main.dart --flavor independent"
    description: Run the 'photos' app in independent mode.

  run:auth:apk:
    run: melos exec --scope="auth" -- "flutter run -t lib/main.dart --flavor independent"
    description: Run the 'auth' app in independent mode.

  run:locker:apk:
    run: melos exec --scope="locker" -- "flutter run -t lib/main.dart --flavor independent"
    description: Run the 'locker' app in independent mode.

 # --- APP-SPECIFIC BUILD COMMANDS ---

  build:photos:apk:
    run: melos exec --scope="photos" -- "flutter build apk --release"
    description: Build a release APK for the 'photos' app.

  build:auth:appbundle:
    run: melos exec --scope="auth" -- "flutter build appbundle --release"
    description: Build a release AppBundle for the 'auth' app.

  build:locker:ios:
    run: melos exec --scope="locker" -- "flutter build ios --release"
    description: Build a release iOS archive for the 'locker' app.